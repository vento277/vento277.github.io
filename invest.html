<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" charset="UTF-8">
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
    <title>Investments</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon/favicon.ico">
    <script src="https://esm.sh/css-doodle/css-doodle.min.js?raw"></script>
    <style>
        /* Tables */
        table {
            width: 100%;
            margin-bottom: 2rem;
            border-collapse: collapse;
        }
        
        th {
            background: inherit;
            padding: 0.75rem;
            text-align: center;
        }
        
        table, th, td {
            border: 0.5px solid #afafaf;
        }
        
        td {
            padding: 0.5rem;
        }

        /* SVG Graph */
        svg.graph-svg {
            width: 100%;
            overflow: visible;
        }
        
        .axis, .grid-line {
            stroke: #333;
            stroke-width: 1;
        }
        
        .solid-line {
            fill: none;
            stroke: #000;
            stroke-width: 2;
        }
        
        .dotted-line {
            fill: none;
            stroke: #000;
            stroke-width: 2;
            stroke-dasharray: 5, 5;
        }
        
        .data-point {
            fill: #000;
            cursor: pointer;
        }
        
        .label, .tooltip, .legend {
            fill: #000;
            font-family: 'Inter', Arial, sans-serif;
            font-size: 12px;
        }
        
        .tooltip {
            visibility: hidden;
            font-size: 12px;
            pointer-events: none;
        }
        
        .legend-line {
            stroke: #000;
            stroke-width: 2;
        }
    </style>
</head>

<html>
    <body>
        <main>
            <h1 style="text-align: center;">KP HOLDINGS</h1>
            <p class="source" style="text-align: center;">Practicing the art of stock picking</p>
            <hr>

            <svg id="performance-graph" class="graph-svg"></svg>    
            <br><br>
            
            <table>
                <thead>
                    <tr>
                        <th colspan="4">Quarterly</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="width: 150px;"><a href="invest/250331.pdf">Q1 2025</a></td>
                        <td style="width: 150px;">Q2 2025</td>
                        <td style="width: 150px;">Q3 2025</td>
                        <td style="width: 150px;">Annual</td>
                    </tr>
                    <tr>
                        <td style="width: 150px;"><a href="#"> </a></td>
                        <td style="width: 150px;"><a href="#"> </a></td>
                        <td style="width: 150px;"><a href="invest/240930.pdf">Q3 2024</a></td>
                        <td style="width: 150px;"><a href="invest/241231.pdf">Annual</a></td>
                    </tr>
                </tbody>
            </table>
        <section class="footer-menu">
            <p>
                &copy; KP HOLDINGS (<a href="https://x.com/_kpeter12">X</a>)
            </p>
        </section>
        </main>
    </body>
</html>

<script>
    // Performance data
    const portfolioData = [
        ["Incep.", 100],
        ["Q3'24", 105.22],
        ["Q4'24", 113.58],
        ["Q1'25", 114.70]
    ];

    const benchmarkData = [
        ["Q2'24", 100],
        ["Q3'24", 104.56],
        ["Q4'24", 113.77],
        ["Q1'25", 108.95]
    ];

    // Graph rendering
    const svg = document.getElementById('performance-graph');
    const graphContainer = svg.parentElement;
    const padding = 40;

    function renderGraph() {
        const width = graphContainer.clientWidth;
        const height = 400;
        
        svg.setAttribute('width', width);
        svg.setAttribute('height', height);

        // Calculate scale bounds
        const allPoints = [...portfolioData, ...benchmarkData];
        const yValues = allPoints.map(point => point[1]);
        const yMin = Math.floor(Math.min(...yValues) / 10) * 10;
        const yMax = Math.ceil(Math.max(...yValues) / 10) * 10;

        // Scale functions
        const scaleX = (index) => padding + (index / (portfolioData.length - 1)) * (width - 2 * padding);
        const scaleY = (y) => height - padding - ((y - yMin) / (yMax - yMin)) * (height - 2 * padding);

        // Clear SVG
        svg.innerHTML = '';

        // Draw axes
        svg.innerHTML += `
            <line x1="${padding}" y1="${padding}" x2="${padding}" y2="${height - padding}" class="axis" />
            <line x1="${padding}" y1="${height - padding}" x2="${width - padding}" y2="${height - padding}" class="axis" />
        `;

        // Draw Y-axis labels
        const yRange = yMax - yMin;
        const yTickCount = Math.floor(yRange / 10) + 1;
        for (let i = 0; i < yTickCount; i++) {
            const yValue = yMin + i * 10;
            const y = scaleY(yValue);
            svg.innerHTML += `
                <line x1="${padding - 5}" y1="${y}" x2="${padding}" y2="${y}" class="grid-line" />
                <text x="${padding - 10}" y="${y + 4}" class="label" text-anchor="end">$${yValue}</text>
            `;
        }

        // Draw X-axis labels
        portfolioData.forEach((point, index) => {
            const x = scaleX(index);
            svg.innerHTML += `
                <text x="${x}" y="${height - padding + 20}" class="label" text-anchor="middle">${point[0]}</text>
            `;
        });

        // Draw portfolio line
        let portfolioPath = '';
        portfolioData.forEach((point, index) => {
            const x = scaleX(index);
            const y = scaleY(point[1]);
            portfolioPath += index === 0 ? `M ${x},${y}` : ` L ${x},${y}`;
        });
        svg.innerHTML += `<path d="${portfolioPath}" class="solid-line" />`;

        // Draw benchmark line
        let benchmarkPath = '';
        benchmarkData.forEach((point, index) => {
            const x = scaleX(index);
            const y = scaleY(point[1]);
            benchmarkPath += index === 0 ? `M ${x},${y}` : ` L ${x},${y}`;
        });
        svg.innerHTML += `<path d="${benchmarkPath}" class="dotted-line" />`;

        // Draw data points with tooltips
        [portfolioData, benchmarkData].forEach((dataset, setIndex) => {
            dataset.forEach((point, index) => {
                const x = scaleX(index);
                const y = scaleY(point[1]);
                const pointId = `point-${setIndex}-${index}`;
                svg.innerHTML += `
                    <circle cx="${x}" cy="${y}" r="3.5" class="data-point" id="${pointId}" />
                    <text x="${x + 10}" y="${y - 10}" class="tooltip" id="tooltip-${pointId}">${point[0]}: ${point[1].toFixed(2)}</text>
                `;
            });
        });

        // Add legend
        svg.innerHTML += `
            <g transform="translate(${width - padding - 80}, ${padding})">
                <line x1="0" y1="0" x2="25" y2="0" class="legend-line solid-line" />
                <text x="30" y="4" class="legend">KP</text>
                <line x1="0" y1="15" x2="25" y2="15" class="legend-line dotted-line" />
                <text x="30" y="19" class="legend">VFV</text>
            </g>
        `;

        // Add event listeners
        addTooltipInteractivity();
    }

    function addTooltipInteractivity() {
        document.querySelectorAll('.data-point').forEach(point => {
            const tooltip = document.getElementById(`tooltip-${point.id}`);
            
            // Mouse events (desktop/laptop)
            point.addEventListener('mouseover', () => {
                tooltip.style.visibility = 'visible';
            });
            
            point.addEventListener('mouseout', () => {
                tooltip.style.visibility = 'hidden';
            });
            
            point.addEventListener('mousemove', (e) => {
                const rect = svg.getBoundingClientRect();
                tooltip.setAttribute('x', e.clientX - rect.left + 10);
                tooltip.setAttribute('y', e.clientY - rect.top - 10);
            });
            
            // Touch events (mobile)
            point.addEventListener('touchstart', (e) => {
                e.preventDefault();
                tooltip.style.visibility = 'visible';
                const touch = e.touches[0];
                const rect = svg.getBoundingClientRect();
                tooltip.setAttribute('x', touch.clientX - rect.left + 10);
                tooltip.setAttribute('y', touch.clientY - rect.top - 10);
            });
            
            point.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const rect = svg.getBoundingClientRect();
                tooltip.setAttribute('x', touch.clientX - rect.left + 10);
                tooltip.setAttribute('y', touch.clientY - rect.top - 10);
            });
            
            point.addEventListener('touchend', () => {
                tooltip.style.visibility = 'hidden';
            });
        });
    }

    // Initialize graph and handle window resizing
    renderGraph();
    window.addEventListener('resize', renderGraph);
</script>